---
title: "Green BUildings"
author: "Rocco Lange, Pedro Ivo Rivas"
date: "8/18/2019"
output: 
  md_document:
    variant: gfm
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
rm(list=ls())
library(mosaic)
library(tidyverse)
greenbuildings = read.csv('greenbuildings.csv')
gb1 = mutate(greenbuildings,
       rent_diff_cluster = ((Rent / cluster_rent ) - 1))
gb1$green_rating = ifelse(gb1$green_rating==1, "Green", "Non-Green")
gb1$class_type = gb1$class_a*2 + gb1$class_b
gb1$class_type = ifelse(gb1$class_type==0, "Class C", ifelse(gb1$class_type==1, "Class B", "Class A"))
gb1$net = ifelse(gb1$net==1,"Utilities Paid","Utilities Not Paid")
```


# GREEN BUILDINGS

## Green Buildings have higher Proportion of Class A buildings

The data was compared by class to check the proportions of green buildings versus non-green buildings in each class.  It was found that green buildings had a much higher proportion of Class A buildings, more than double the proportion of Class A non-green buildings.

```{r, echo=FALSE}
ggplot(data = gb1, mapping = aes(x=gb1$class_type, y=..prop.., fill=gb1$green_rating, group=gb1$green_rating)) +
  geom_bar(position = position_dodge(), color='black') +  
  scale_fill_manual(values=c("#32CD32", "#E69F00")) +
  labs(title="Bar plot", 
       subtitle="Class by Green Rating",
       caption="Source: greenbuilding data set in R",
       x="Class", y="Proportion",
       fill="Green Rating") 
```

## Class A buildings have higher mean Rent

This could be a factor in the mean rent for green buildings being higher than the mean rent for non-green buildings.  Class A buildings were found to have a mean rent of $32.32, which was nearly $6 higher than Class B and almost $9 more than Class C. 

```{r}
gb1 %>% 
group_by(class_type) %>% 
summarise(AverageRent = mean(Rent)) %>% 
  ggplot(aes(factor(class_type), AverageRent, label=round(AverageRent, 2), fill=factor(class_type))) +
  geom_col(position = position_dodge(), color='black') +
  scale_fill_manual(values=c("#4682B4", "#48D1CC", '#B22222')) +
  geom_text(position=position_dodge(width = 0.9),vjust = -0.3) +
  labs(title="Bar plot",
       subtitle="Mean Rent by Class",
       caption="Source: greenbuilding data set in R",
       x="Class", y="Mean Rent (dollars)", fill="Class")
```

## Green Buildings are overrepresented by Class A Buildings

This suggests that since green buildings are represented by a higher proportion of Class A buildings their mean rent is distorted.  Even though for each class, except C, they are actually cheaper than non-green buildings.

```{r}
gb1 %>% 
group_by(class_type, green_rating) %>% 
summarise(AverageRent = mean(Rent)) %>% 
  ggplot(aes(factor(class_type), AverageRent, label=round(AverageRent, 2), fill=factor(green_rating))) +
  geom_col(position = position_dodge(), color='black') +
  scale_fill_manual(values=c("#32CD32", "#E69F00")) +
  geom_text(position=position_dodge(width = 0.9),vjust = -0.3) +
  labs(title="Bar plot",
       subtitle="Mean Rent by Class",
       caption="Source: greenbuilding data set in R",
       x="Class", y="Mean Rent (dollars)", fill="Green Rating")
```

## Conclusion

In summary, the mean price for green buildings is distorted by other underlying factors such as class that make a direct impact on price whether they are green or not. Since there are different proportions of each class of building per green type, they are not comparable on green type alone.  